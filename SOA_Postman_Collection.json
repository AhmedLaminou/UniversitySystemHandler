{
  "info": {
    "name": "SOA University System - Complete API Tests",
    "description": "Collection de tests pour tous les services SOA",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "localhost"
    },
    {
      "key": "token",
      "value": "",
      "type": "string"
    },
    {
      "key": "student_id",
      "value": "STU001",
      "type": "string"
    },
    {
      "key": "course_id",
      "value": "COURSE001",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "üîê AUTHENTIFICATION (Auth Service - Port 8080)",
      "item": [
        {
          "name": "1Ô∏è‚É£ Register - Cr√©er un compte",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"ahmed@university.edu\",\n  \"password\": \"SecurePass123!\",\n  \"firstName\": \"Ahmed\",\n  \"lastName\": \"Laminou\",\n  \"role\": \"STUDENT\"\n}"
            },
            "url": {
              "raw": "{{base_url}}:8080/auth/register",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8080",
              "path": [
                "auth",
                "register"
              ]
            },
            "description": "Cr√©er un nouveau compte utilisateur"
          },
          "response": []
        },
        {
          "name": "2Ô∏è‚É£ Login - Se connecter",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "  var jsonData = pm.response.json();",
                  "  pm.environment.set(\"token\", jsonData.token);",
                  "  pm.environment.set(\"user_id\", jsonData.id);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"ahmed@university.edu\",\n  \"password\": \"SecurePass123!\"\n}"
            },
            "url": {
              "raw": "{{base_url}}:8080/auth/login",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8080",
              "path": [
                "auth",
                "login"
              ]
            },
            "description": "Se connecter et obtenir un JWT token (le token est automatiquement sauvegard√©)"
          },
          "response": []
        },
        {
          "name": "3Ô∏è‚É£ Validate Token - Valider le token",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}:8080/auth/validate",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8080",
              "path": [
                "auth",
                "validate"
              ]
            },
            "description": "Valider que le token JWT est correct"
          },
          "response": []
        },
        {
          "name": "4Ô∏è‚É£ Refresh Token - Renouveler le token",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"refreshToken\": \"{{token}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}:8080/auth/refresh",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8080",
              "path": [
                "auth",
                "refresh"
              ]
            },
            "description": "Obtenir un nouveau token (rafra√Æchir)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "üë• SERVICE √âTUDIANTS (Port 3000)",
      "item": [
        {
          "name": "1Ô∏è‚É£ List All Students - Lister tous les √©tudiants",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}:3000/api/students",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "3000",
              "path": [
                "api",
                "students"
              ]
            },
            "description": "R√©cup√©rer la liste compl√®te des √©tudiants"
          },
          "response": []
        },
        {
          "name": "2Ô∏è‚É£ Create Student - Cr√©er un √©tudiant",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201 || pm.response.code === 200) {",
                  "  var jsonData = pm.response.json();",
                  "  pm.environment.set(\"student_id\", jsonData._id || jsonData.id);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"matricule\": \"STU001\",\n  \"firstName\": \"Fatima\",\n  \"lastName\": \"Ben Ahmed\",\n  \"email\": \"fatima@university.edu\",\n  \"program\": \"G√©nie Logiciel\",\n  \"enrollmentDate\": \"2024-09-01\"\n}"
            },
            "url": {
              "raw": "{{base_url}}:3000/api/students",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "3000",
              "path": [
                "api",
                "students"
              ]
            },
            "description": "Cr√©er un nouveau profil √©tudiant (l'ID est automatiquement sauvegard√©)"
          },
          "response": []
        },
        {
          "name": "3Ô∏è‚É£ Get Student By ID - R√©cup√©rer un √©tudiant",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}:3000/api/students/{{student_id}}",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "3000",
              "path": [
                "api",
                "students",
                "{{student_id}}"
              ]
            },
            "description": "R√©cup√©rer les d√©tails d'un √©tudiant sp√©cifique"
          },
          "response": []
        },
        {
          "name": "4Ô∏è‚É£ Update Student - Modifier un √©tudiant",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"firstName\": \"Fatima\",\n  \"lastName\": \"Ben Ahmed Updated\",\n  \"email\": \"fatima.updated@university.edu\",\n  \"program\": \"G√©nie Logiciel et Syst√®mes d'Information\"\n}"
            },
            "url": {
              "raw": "{{base_url}}:3000/api/students/{{student_id}}",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "3000",
              "path": [
                "api",
                "students",
                "{{student_id}}"
              ]
            },
            "description": "Modifier les informations d'un √©tudiant"
          },
          "response": []
        },
        {
          "name": "5Ô∏è‚É£ Delete Student - Supprimer un √©tudiant",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}:3000/api/students/{{student_id}}",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "3000",
              "path": [
                "api",
                "students",
                "{{student_id}}"
              ]
            },
            "description": "Supprimer un profil √©tudiant"
          },
          "response": []
        },
        {
          "name": "6Ô∏è‚É£ Search Students - Rechercher des √©tudiants",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}:3000/api/students?firstName=Ahmed",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "3000",
              "path": [
                "api",
                "students"
              ],
              "query": [
                {
                  "key": "firstName",
                  "value": "Ahmed"
                }
              ]
            },
            "description": "Rechercher des √©tudiants par crit√®re"
          },
          "response": []
        }
      ]
    },
    {
      "name": "üìä SERVICE NOTES (Port 8000)",
      "item": [
        {
          "name": "1Ô∏è‚É£ List All Grades - Lister toutes les notes",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}:8000/api/grades",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8000",
              "path": [
                "api",
                "grades"
              ]
            },
            "description": "R√©cup√©rer la liste compl√®te des notes"
          },
          "response": []
        },
        {
          "name": "2Ô∏è‚É£ Create Grade - Ajouter une note",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200 || pm.response.code === 201) {",
                  "  var jsonData = pm.response.json();",
                  "  pm.environment.set(\"grade_id\", jsonData.id);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"student_id\": \"{{student_id}}\",\n  \"course_id\": \"COURSE001\",\n  \"grade\": 92.5,\n  \"feedback\": \"Excellent travail\"\n}"
            },
            "url": {
              "raw": "{{base_url}}:8000/api/grades",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8000",
              "path": [
                "api",
                "grades"
              ]
            },
            "description": "Cr√©er une nouvelle note pour un √©tudiant"
          },
          "response": []
        },
        {
          "name": "3Ô∏è‚É£ Get Student Grades - Notes d'un √©tudiant",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}:8000/api/grades/student/{{student_id}}",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8000",
              "path": [
                "api",
                "grades",
                "student",
                "{{student_id}}"
              ]
            },
            "description": "R√©cup√©rer toutes les notes d'un √©tudiant sp√©cifique"
          },
          "response": []
        },
        {
          "name": "4Ô∏è‚É£ Get Student Average - Moyenne d'un √©tudiant",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}:8000/api/grades/student/{{student_id}}/average",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8000",
              "path": [
                "api",
                "grades",
                "student",
                "{{student_id}}",
                "average"
              ]
            },
            "description": "Calculer la moyenne g√©n√©rale d'un √©tudiant"
          },
          "response": []
        },
        {
          "name": "5Ô∏è‚É£ Update Grade - Modifier une note",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"grade\": 95.0,\n  \"feedback\": \"Excellent ! Correction faite\"\n}"
            },
            "url": {
              "raw": "{{base_url}}:8000/api/grades/{{grade_id}}",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8000",
              "path": [
                "api",
                "grades",
                "{{grade_id}}"
              ]
            },
            "description": "Modifier une note existante"
          },
          "response": []
        },
        {
          "name": "6Ô∏è‚É£ Delete Grade - Supprimer une note",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}:8000/api/grades/{{grade_id}}",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8000",
              "path": [
                "api",
                "grades",
                "{{grade_id}}"
              ]
            },
            "description": "Supprimer une note"
          },
          "response": []
        }
      ]
    },
    {
      "name": "üí∞ SERVICE FACTURATION (Port 8081 - SOAP)",
      "item": [
        {
          "name": "1Ô∏è‚É£ Get Invoices - R√©cup√©rer les factures",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "text/xml"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\n                   xmlns:bil=\"http://billing.nexis.com\">\n   <soapenv:Header/>\n   <soapenv:Body>\n      <bil:getInvoices>\n         <studentId>STU001</studentId>\n      </bil:getInvoices>\n   </soapenv:Body>\n</soapenv:Envelope>"
            },
            "url": {
              "raw": "{{base_url}}:8081/api/services/billing",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8081",
              "path": [
                "api",
                "services",
                "billing"
              ]
            },
            "description": "R√©cup√©rer les factures d'un √©tudiant (SOAP)"
          },
          "response": []
        },
        {
          "name": "2Ô∏è‚É£ Create Invoice - Cr√©er une facture",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "text/xml"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\n                   xmlns:bil=\"http://billing.nexis.com\">\n   <soapenv:Header/>\n   <soapenv:Body>\n      <bil:createInvoice>\n         <studentId>STU001</studentId>\n         <amount>5000.00</amount>\n         <description>Frais de scolarit√© - Semestre 1</description>\n         <dueDate>2025-01-31</dueDate>\n      </bil:createInvoice>\n   </soapenv:Body>\n</soapenv:Envelope>"
            },
            "url": {
              "raw": "{{base_url}}:8081/api/services/billing",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8081",
              "path": [
                "api",
                "services",
                "billing"
              ]
            },
            "description": "Cr√©er une nouvelle facture pour un √©tudiant (SOAP)"
          },
          "response": []
        },
        {
          "name": "3Ô∏è‚É£ Get Payments - R√©cup√©rer les paiements",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "text/xml"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\n                   xmlns:bil=\"http://billing.nexis.com\">\n   <soapenv:Header/>\n   <soapenv:Body>\n      <bil:getPayments>\n         <studentId>STU001</studentId>\n      </bil:getPayments>\n   </soapenv:Body>\n</soapenv:Envelope>"
            },
            "url": {
              "raw": "{{base_url}}:8081/api/services/billing",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8081",
              "path": [
                "api",
                "services",
                "billing"
              ]
            },
            "description": "R√©cup√©rer l'historique des paiements d'un √©tudiant (SOAP)"
          },
          "response": []
        },
        {
          "name": "4Ô∏è‚É£ Record Payment - Enregistrer un paiement",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "text/xml"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\n                   xmlns:bil=\"http://billing.nexis.com\">\n   <soapenv:Header/>\n   <soapenv:Body>\n      <bil:recordPayment>\n         <invoiceId>INV001</invoiceId>\n         <studentId>STU001</studentId>\n         <amount>5000.00</amount>\n         <paymentMethod>BANK_TRANSFER</paymentMethod>\n         <referenceNumber>BANK20251215001</referenceNumber>\n      </bil:recordPayment>\n   </soapenv:Body>\n</soapenv:Envelope>"
            },
            "url": {
              "raw": "{{base_url}}:8081/api/services/billing",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8081",
              "path": [
                "api",
                "services",
                "billing"
              ]
            },
            "description": "Enregistrer un paiement pour une facture (SOAP)"
          },
          "response": []
        },
        {
          "name": "5Ô∏è‚É£ Get Balance - Solde d'un √©tudiant",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "text/xml"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\n                   xmlns:bil=\"http://billing.nexis.com\">\n   <soapenv:Header/>\n   <soapenv:Body>\n      <bil:getBalance>\n         <studentId>STU001</studentId>\n      </bil:getBalance>\n   </soapenv:Body>\n</soapenv:Envelope>"
            },
            "url": {
              "raw": "{{base_url}}:8081/api/services/billing",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8081",
              "path": [
                "api",
                "services",
                "billing"
              ]
            },
            "description": "R√©cup√©rer le solde/montant d√ª par un √©tudiant (SOAP)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "üåê HEALTH CHECKS",
      "item": [
        {
          "name": "Health Check - Auth Service",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}:8080/actuator/health",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8080",
              "path": [
                "actuator",
                "health"
              ]
            },
            "description": "V√©rifier si Auth Service est op√©rationnel"
          },
          "response": []
        },
        {
          "name": "Health Check - Student Service",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}:3000/health",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "3000",
              "path": [
                "health"
              ]
            },
            "description": "V√©rifier si Student Service est op√©rationnel"
          },
          "response": []
        },
        {
          "name": "Health Check - Grade Service",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}:8000/health",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8000",
              "path": [
                "health"
              ]
            },
            "description": "V√©rifier si Grade Service est op√©rationnel"
          },
          "response": []
        },
        {
          "name": "Health Check - Billing Service",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{base_url}}:8081/actuator/health",
              "protocol": "http",
              "host": [
                "{{base_url}}"
              ],
              "port": "8081",
              "path": [
                "actuator",
                "health"
              ]
            },
            "description": "V√©rifier si Billing Service est op√©rationnel"
          },
          "response": []
        }
      ]
    }
  ]
}
